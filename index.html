<!DOCTYPE html>
<!-- saved from url=(0084)index.html -->
<html lang="ja">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
    (function() {
      var container = document.querySelector('#_tcx-i5mj7d7x6d');
      if (!container) {
        return;
      }

      var XHR = XMLHttpRequest.prototype;
      var send = XHR.send;
      var open = XHR.open;
      XHR.open = function(method, url) {
        this.url = url;
        return open.apply(this, arguments);
      };
      XHR.send = function() {
        this.addEventListener('load', function() {
          try {
            const response = this.response;
            if (response && response.length) {
              const firstChar = response[0];
              if (firstChar === '[' || firstChar === '{') {
                const wrapper = document.createElement('div');
                wrapper.setAttribute('data-tcx-url', this.url);
                wrapper.innerText = response;
                container.appendChild(wrapper);
              }
            }
          } catch (err) {
            // No-op.
          }
        });
        return send.apply(this, arguments);
      };
    })();
  </script>
  <script async="" src="media-hud1/analytics.js"></script>
  <script type="text/javascript" async="" src="media-hud1/ga.js"></script>
  <script type="text/javascript" async="" src="media-hud1/ga.js"></script>
  <script src="media-hud1/analytics.js(1)" type="text/javascript"></script>
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', function() {
      var v = archive_analytics.values;
      v.service = 'wb';
      v.server_name = 'wwwb-app101.us.archive.org';
      v.server_ms = 322;
      archive_analytics.send_pageview({});
    });
  </script>
  <script type="text/javascript" src="media-hud1/ait-client-rewrite.js" charset="utf-8"></script>
  <script type="text/javascript">
    WB_wombat_Init("https://web.archive.org/web/", "20171014193028", "masterpoppy.inspi.me");
  </script>
  <script type="text/javascript" src="media-hud1/wbhack.js" charset="utf-8"></script>
  <script type="text/javascript">
    __wbhack.init('https://web.archive.org/web');
  </script>
  <link rel="stylesheet" type="text/css" href="media-hud1/banner-styles.css">
  <link rel="stylesheet" type="text/css" href="media-hud1/iconochive.css">
  <!-- End Wayback Rewrite JS Include -->
  <title>Media HUD...HTMLでHUDを開発する(1/3) | Mad Scripter's Lab @ inspi</title>
  <link rel="shortcut icon" href="https://web.archive.org/web/20171014193028im_/http://masterpoppy.inspi.me/wp-content/themes/platformpro_dev/admin/images/favicon-pagelines.ico" type="image/x-icon">
  <link rel="profile" href="http://gmpg.org/xfn/11">
  <link rel="dns-prefetch" href="http://s.w.org/">
  <link rel="alternate" type="application/rss+xml" title="Mad Scripter&#39;s Lab @ inspi » フィード" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/feed">
  <link rel="alternate" type="application/rss+xml" title="Mad Scripter&#39;s Lab @ inspi » コメントフィード" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/comments/feed">
  <link rel="alternate" type="application/rss+xml" title="Mad Scripter&#39;s Lab @ inspi » Media HUD…HTMLでHUDを開発する(1/3) のコメントのフィード" href="index.html/feed">
  <link rel="https://api.w.org/" href="http://masterpoppy.inspi.me/wp-json/">
  <link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/xmlrpc.php?rsd">
  <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/wp-includes/wlwmanifest.xml">
  <link rel="prev" title="中級LSLスクリプト TIPS その３ “極シンプルなSkybox向けセキュリティ”" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/archives/968">
  <link rel="next" title="Media HUD…HTMLでHUDを開発する(2/3)" href="index2.html">
  <link rel="shortlink" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/?p=1003">
  <link rel="alternate" type="application/json+oembed" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fmasterpoppy.inspi.me%2Farchives%2F1003">
  <link rel="alternate" type="text/xml+oembed" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fmasterpoppy.inspi.me%2Farchives%2F1003&amp;format=xml">
  <link rel="canonical" href="index.html">
  <meta name="description" content="年末好例 セカンドライフ技術系 Advent Calendar 2016 の季節ですね。 今年は連載で新しいネタを投下します。 今日の記事は前座です。 なぜ今HUDをHTMLで作るか？ 従来HUDというとノーマルプリムやMeshで組み立ててllSetColorで色を変えたり、 llSetTextや...">
  <meta name="google-site-verification" content="ShocgonYlShlHZbVG44JZK4oyVab2Z7XOvzwPgugMQM">
  <meta name="msvalidate.01" content="B98A972EAC20F49C24F6D94FD28FFAA5">
  <link rel="stylesheet" type="text/css" href="media-hud1/shCore.css">
  <link rel="stylesheet" type="text/css" href="media-hud1/shThemeDefault.css">
  <style type="text/css" id="syntaxhighlighteranchor"></style>
  <link type="text/css" rel="stylesheet" href="media-hud1/f84aedcec0c43b737184236d278448e5-compressor-part.css" media="all">
  <!--[if IE 7]>
  <link rel='stylesheet' id='ie7-style-css'  href='http://masterpoppy.inspi.me/wp-content/themes/platformpro/css/ie7.css?ver=1.5.3' type='text/css' media='all' />
  <![endif]-->
  <link type="text/css" rel="stylesheet" href="media-hud1/327e52d74cbc62acdb040686dfea4e50-compressor-part.css" media="all">
  <link type="text/css" rel="stylesheet" href="media-hud1/42350d1b9ecea3936e43f71ff8f6b2f9-compressor-part.css" media="screen">
  <link type="text/css" rel="stylesheet" href="media-hud1/3277578f91c0afa6bdf5ae3ae9f14902-compressor-part.css" media="all">
  <link type="text/css" rel="stylesheet" href="media-hud1/3278b6ba956e917349e18b71138500cf-compressor-part.css" media="screen">
  <link type="text/css" rel="stylesheet" href="media-hud1/dfffcb3f629606f3df04d506f4da8efa-compressor-part.css" media="all">
  <link type="text/css" rel="stylesheet" href="media-hud1/c2c2bb609ee2747a26cca63dab3753d9-compressor-part.css" media="print">
  <link type="text/css" rel="stylesheet" href="media-hud1/3f9e39c0f5a50860dcc6494d02afbef0-compressor-part.css" media="screen">
  <link type="text/css" rel="stylesheet" href="media-hud1/b690fea58dcdfca0dd797caa1c69ab53-compressor-part.css" media="all">
  <!--[if lt IE 8]>
  <script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE8.js"></script>
  <![endif]-->
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-10700788-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl/' : 'http://www/') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script type="text/javascript" src="media-hud1/4e5bb06590f91f015feda8f99a7f6da9-compressor-part.js"></script>
  <script type="text/javascript">
    var _gaq = _gaq || [];

    _gaq.push(['_setAccount', 'UA-26362892-1']);
    _gaq.push(['_setDomainName', 'none']);
    _gaq.push(['_setAllowLinker', true]);
    _gaq.push(['_setAllowHash', false]);
    _gaq.push(['_trackPageview']);


    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://web.archive.org/web/20171014193028/https://ssl/' : 'https://web.archive.org/web/20171014193028/http://www/') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//web.archive.org/web/20171014193028/http://www.google-analytics.com/analytics.js', 'gaplusu');


    gaplusu('create', 'UA-10700788-3', 'auto', {
      'name': 'single'
    });

    gaplusu('single.set', 'anonymizeIp', true);

    gaplusu('single.send', 'pageview');
  </script>
  <script type="text/javascript" src="media-hud1/3774a467274ee29ab85342ea34875ad3-compressor-part.js"></script>
</head>

<body class="post-template-default single single-post postid-1003 single-format-standard admin-bar no-customize-support canvas buddypress ttype-single tmain-single no-js">
  <!-- BEGIN WAYBACK TOOLBAR INSERT -->
  <script type="text/javascript" src="media-hud1/timestamp.js" charset="utf-8"></script>
  <script type="text/javascript" src="media-hud1/graph-calc.js" charset="utf-8"></script>
  <script type="text/javascript" src="media-hud1/auto-complete.js" charset="utf-8"></script>
  <script type="text/javascript" src="media-hud1/toolbar.js" charset="utf-8"></script>
  <style type="text/css">
    body {
      margin-top: 0 !important;
      padding-top: 0 !important;
      /*min-width:800px !important;*/
    }

    .wb-autocomplete-suggestions {
      text-align: left;
      cursor: default;
      border: 1px solid #ccc;
      border-top: 0;
      background: #fff;
      box-shadow: -1px 1px 3px rgba(0, 0, 0, .1);
      position: absolute;
      display: none;
      z-index: 2147483647;
      max-height: 254px;
      overflow: hidden;
      overflow-y: auto;
      box-sizing: border-box;
    }

    .wb-autocomplete-suggestion {
      position: relative;
      padding: 0 .6em;
      line-height: 23px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 1.02em;
      color: #333;
    }

    .wb-autocomplete-suggestion b {
      font-weight: bold;
    }

    .wb-autocomplete-suggestion.selected {
      background: #f0f0f0;
    }
  </style>
  <!--
  <div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;">
  </div>
  -->
  <script type="text/javascript">
    __wm.bt(600, 27, 25, 2, "web", "http://masterpoppy.inspi.me/archives/1003", "2017-10-14", 1996, "/_static/", ['css/banner-styles.css', 'css/iconochive.css']);
  </script>
  <div class="wb-autocomplete-suggestions "></div>
  <!-- END WAYBACK TOOLBAR INSERT -->
  <div id="site" class="one-sidebar-left">
    <div id="page">
      <div id="page-canvas">
        <div id="header" class="container-group fix">
          <!--
          <div class="outline">
            <div id="branding" class="container fix">
              <div class="texture">
                <div class="content">
                  <div class="content-pad">
                    <div class="branding_wrap">
                      <div class="title-container">
                        <a class="home site-title" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/" title="Home">Mad Scripter's Lab @ inspi</a>
                        <h6 class="site-description subhead">しがないスクリプト屋さんのブログ</h6>
                      </div>
                      <div class="icons" style="bottom: 21px; right: 1px;">
                        <a target="_blank" href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/feed" class="rsslink"></a>
                        <a target="_blank" href="https://web.archive.org/web/20171014193028/https://twitter.com/#!/MasterPoppy" class="twitterlink"></a>
                        <a target="_blank" href="https://web.archive.org/web/20171014193028/http://www.youtube.com/user/MasterPoppyAmat" class="youtubelink"></a>
                      </div>
                    </div>
                    <div class="clear"></div>
                  </div>
                </div>
              </div>
            </div>
            <div id="primary-nav" class="container fix">
              <div class="texture">
                <div class="content">
                  <div class="content-pad">
                    <div id="nav_row" class="main_nav fix">
                      <ul id="menu-nav" class="main-nav sf-menu">
                        <li class="page_item page-item-6 page_item_has_children"><a href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/about">筆者について</a>
                          <ul class="children">
                            <li class="page_item page-item-75"><a href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/about/club-mk">Club MK</a></li>
                            <li class="page_item page-item-79"><a href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/about/customwork">スクリプトのオーダーについて</a></li>
                          </ul>
                        </li>
                        <li class="page_item page-item-577"><a href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/kokuban">MessageBoard For Japanese</a></li>
                        <li class="page_item page-item-131"><a href="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/viewer3%e5%85%a5%e9%96%80">Viewer3入門</a></li>
                      </ul>
                      <form method="get" class="searchform" action="https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/" onsubmit="this.submit();return false;">
                        <fieldset>
                          <input type="text" value="Search" name="s" class="searchfield" onfocus="if (this.value == &#39;Search&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;Search&#39;;}">
                          <input type="image" class="submit btn" name="submit" src="media-hud1/search-btn.png" alt="Go">
                        </fieldset>
                      </form>
                    </div>
                    <div class="clear"></div>
                  </div>
                </div>
              </div>
            </div>
            <div id="secondnav" class="container fix">
              <div class="texture">
                <div class="content">
                  <div class="content-pad">
                    <div class="clear"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          -->
        </div>
        <div id="page-main" class="container-group fix">
          <div id="dynamic-content" class="outline fix">
            <div id="maincontent" class="container fix">
              <div class="texture">
                <div class="content">
                  <div class="content-pad">
                    <div id="pagelines_content" class="one-sidebar-left fix">
                      <div id="column-wrap" class="fix">
                        <div id="column-main" class="mcolumn fix">
                          <div class="mcolumn-pad">
                            <div id="postnav" class="copy fix">
                              <div class="copy-pad">
                                <div class="post-nav fix">
                                  <!-- <span class="previous"><a href="http://masterpoppy.inspi.me/archives/968" rel="prev">中級LSLスクリプト TIPS その３ “極シンプルなSkybox向けセキュリティ”</a></span> -->
                                  <div>中級LSLスクリプト TIPS その３ “極シンプルなSkybox向けセキュリティ</div>
                                  <span class="next"><a href="index2.html" rel="next">Media HUD…HTMLでHUDを開発する(2/3)</a></span>
                                </div>
                                <div class="clear"></div>
                              </div>
                            </div>
                            <div id="theloop" class="copy fix">
                              <div class="copy-pad">
                                <div class="fpost post-1003 post type-post status-publish format-standard hentry category-lsl category-sl" id="post-1003">
                                  <div class="post-meta fix">
                                    <div class="post-header fix post-nothumb" style="">
                                      <div class="post-title-section fix">
                                        <div class="post-title fix">
                                          <h1 class="entry-title">Media HUD…HTMLでHUDを開発する(1/3)</h1>
                                          <div class="metabar"><em><span class="sword">By</span>
                                              <span class="author vcard"><span class="fn">MasterPoppy</span></span>
                                              <span class="sword">On</span>
                                              <span class="date time published" title="2016-12-21T06:00:41+0000">2016-12-21</span> · <span class="post-comments">1 Comment</span>
                                            </em></div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="entry_wrap fix">
                                    <div class="entry_content">
                                      <p><img class="wp-image-1085 size-medium alignnone" src="media-hud1/html_css_javascript_and_the_awesome_jquery_infographic_header-512x353.png" alt="html_css_javascript_and_the_awesome_jquery_infographic_header"
                                          width="512" height="353"
                                          srcset="media-hud1/html_css_javascript_and_the_awesome_jquery_infographic_header-512x353.png 512w, media-hud1/html_css_javascript_and_the_awesome_jquery_infographic_header-768x529.png 768w, media-hud1/html_css_javascript_and_the_awesome_jquery_infographic_header.png 772w"
                                          sizes="(max-width: 512px) 100vw, 512px"></p>
                                      <p>年末好例 <a href="http://www.adventar.org/calendars/1673" target="_blank">セカンドライフ技術系 Advent Calendar 2016</a> の季節ですね。<br> 今年は連載で新しいネタを投下します。 今日の記事は前座です。</p>
                                      <h2>なぜ今HUDをHTMLで作るか？</h2>
                                      <p>従来HUDというとノーマルプリムやMeshで組み立ててllSetColorで色を変えたり、 llSetTextやXyzzyTextで文字を表示する方法で開発されてきました。 この方法だとダンスHUDやアドベンチャーゲームのテキストウインドウなど、 テキストを大量に表示・書き換えする機能を実装するには文字数やボタンの数に応じてプリムを増やす必要があり、開発環境としては不便なものでした。</p>
                                      <p>この問題への対処として、SharedMedia上にHTMLとJavaScriptなどを利用することで大量の文字列を処理して表示する方法が考えられます。<br> 2011年にもKelly Lindenによる <a href="http://wiki.secondlife.com/wiki/HTML_HUD_Demo"
                                          target="_blank">http-inとHTMLを使ったHUD開発手法</a> が提案されていましたが、当時のViewerだと内蔵WebブラウザがWebkitだったため、最新のWeb技術に準拠した手法が適用できず、いまいち使えない状態でした。</p>
                                      <p>最近のアップデートで内蔵WebブラウザがWebkitからChrome Emmbded Framework(以下CEF)に置き換えられ、以前はSharedMediaに使えなかった新しい規格が利用できるようになりました。
                                        CEFへの置き換えによりHTML5,CSS3,WebGLにいたり概ねなんでも使えるようになったので、SecondLifeのアプリ開発にWeb系のフロントエンドを取り込んでみようという試みを紹介するというのが今回の連載記事の趣旨です。</p>
                                      <p>*CEFについてのLindenの記事<br>
                                        <a href="https://community.secondlife.com/t5/Featured-News/Second-Life-Improvements-What-s-New-amp-What-s-Coming-Soon/ba-p/2973598" target="_blank">Second Life
                                          Improvements – What’s New &amp; What’s Coming Soon!</a><br> *日本語での詳しい解説<br>
                                        <a href="http://sakuranoelfayray.blogspot.jp/2015/12/officialviewer400.html" target="_blank">http://sakuranoelfayray.blogspot.jp/2015/12/officialviewer400.html</a></p>
                                      <p><span id="more-1003"></span></p>
                                      <h2>HTMLでHUDを作るメリット</h2>
                                      <p>HTMLを利用するメリットはいくつか挙げられます。</p>
                                      <ul>
                                        <li><strong> LSLだけでは大変な手間がかかる文字表示や文字装飾が簡単に実装できる。</strong><br> floating textの文字数制限やxyzzytextに力技で改行を実装する煩わしさから開放！</li>
                                        <li><strong>CSSやSVG、あるいはフレームワークを使って簡単にグラフィカルなUIデザインを提供できる。</strong><br> ぶっちゃけフレームワーク使うと楽です</li>
                                        <li><strong>LSLの容量(64kbyte)でもcdnで配布されているjavascriptライブラリなどを呼び出すことで機能を補うことができる。</strong><br> 個人的には <a href="https://jquery.com/" target="_blank">jquery</a>
                                          やGUIフレームワークなどは <a href="https://cdnjs.com/" target="_blank">cdnjs</a> から呼び出すことにしています。</li>
                                        <li><strong>http-inを併用することで外部サーバを用意しなくてもSecondLife内で完結してWebアプリを提供できる。</strong><br> LSLにはhttp通信も実装されているので、 ajaxなどphp製サーバーアプリなどに相当する通信機能もある程度実装できるのも有用です。</li>
                                      </ul>
                                      <p>サーバサイドをhttp-inで実装すると、<a href="http://wiki.secondlife.com/wiki/LlSetContentType"
                                          target="_blank">llSetContentType</a>にOwnerが表示したときにしかtext/htmlを返さない(Owner以外からだとtext/plainになる)という制限があり、 実質的にHUDでしか実装できない＝REZして使うことができないという制約がありますので注意してください。 REZして使うLSL-Webアプリを作りたい場合はWebサーバを外部に用意すれば可能ですが、
                                        Webブラウザにおけるajaxのクロスドメイン制約が適用される場合があるので、 適宜JSONPを利用するなど制約を超える対策を施す必要があります。</p>
                                      <p>ともあれ今回はSecondLife内で完結させたいので、http-inを併用するタイプで解説します。</p>
                                      <p>前提として、今回紹介するHUDには下記の動作環境が必須となります。</p>
                                      <ul>
                                        <li>Second Life 4.0.0 (307894) 以降</li>
                                        <li>Firestorm 4.7.7 (48706) 以降</li>
                                        <li>その他CEFに対応したTPV</li>
                                      </ul>
                                      <p>基本的に公式Viewer・Firestorm共に最新版を使っていれば問題ありません。 古いバージョンだとWebkitで表示されるのでHTML5で記述しているページは表示が崩れたりします。 そのうち古いバージョンではログインできないようにブロックされるらしいので、 いずれはユーザのViewerのバージョンは気にせずHUDを配布できるようになることでしょう。</p>
                                      <p>連載の中でいくつかサンプルコードを紹介しますが、一部の例外をのぞき下記の手法で組み立てます。</p>
                                      <ol>
                                        <li>ノーマルプリムでBOXをRezし、サイズを0.1m×0.8m×0.8mに設定する。</li>
                                        <li>TakeしてHUD中心１またはHUD中心２に装着する。</li>
                                        <li>手前の面(面番号4, X－ 側)を明るさ全開をOnに設定する。</li>
                                        <li>環境設定のメディア再生を自動再生のチェックをOnにする。</li>
                                      </ol>
                                      <h2>サンプルコード1 (静的HTMLの表示)</h2>
                                      <p>お膳立てが済んだところでスクリプトのコードを見ていきます。<br> ここではHTML,CSS,javascript,jqueryなどの初歩的な解説は省略しますがあしからずご了承ください。(_ _;)</p>
                                      <script src="https://gist.github.com/masterpoppy/95989d7c24837f8ff490ec9fc30f5432.js"></script>
                                      <p><a href="media-hud1/WS_0654.png" target="_blank"><img class="alignnone wp-image-1094 size-large" src="media-hud1/WS_0654-1024x564.png" alt="ws_0654" width="917" height="505"
                                            srcset="media-hud1/WS_0654-1024x564.png 1024w, media-hud1/WS_0654-512x282.png 512w, media-hud1/WS_0654-768x423.png 768w" sizes="(max-width: 917px) 100vw, 917px"></a></p>
                                      <p style="text-align: center;">実行結果 (クリックでおおきい画像を表示します)</p>
                                      <p>シンプルに静的HTMLを表示するだけのコードです。 HTMLを使ったスクリプトの基本形は多くの場合において上記のようになります。<br> 一度取り外して再装着するとhttp-inのサーバーURLが無効になるので、サンプルコードではattach()でリセットを掛ける処理をいれてあります。<br> URLにアクセスするとサーバーにHTTPリクエストがGET Methodが送信され、<a
                                          href="http://wiki.secondlife.com/wiki/Http_request/ja" target="_blank">http_request()</a> イベントが発火するのでリクエストIDに対してデータを返す(レスポンス)するというのがWebアプリのアルゴリズムの基本形です。<br>
                                        それぞれのスクリプトで設計された機能により、 主にフロントエンドは string HTML_BODY の部分を、 バックエンドは http_request から返す情報を生成するためにLSLを実装していきます。 LSLではHTTP通信のmethodでは主にGETとPOSTが使われます。llRequestURL() でhttp-inのサーバーリクエストをした時とはじめにページのデータを返すときは必ずGET
                                        Methodでイベントが発火し、それ以降のクライアントアプリとのデータのやり取りは特に決まりはありませんが場合分けし易いようにPOST Methodで処理するのが一般的だと思います。</p>
                                      <p>参考<br> Second Life Wiki &gt; LSL HTTP/ja<br>
                                        <a href="http://wiki.secondlife.com/wiki/Category:LSL_HTTP/ja" target="_blank">http://wiki.secondlife.com/wiki/Category:LSL_HTTP/ja</a><br> Second Life Wiki &gt; LSL
                                        HTTP server/examples/ja<br>
                                        <a href="http://wiki.secondlife.com/wiki/LSL_HTTP_server/examples/ja" target="_blank">http://wiki.secondlife.com/wiki/LSL_HTTP_server/examples/ja</a></p>
                                      <h2>サンプルコード2 (ajaxで動的ページ書き換え)</h2>
                                      <p>1つめのサンプルコードでは静的ページを表示しているだけですが、submitボタンでデータを送信して遷移先のページを動的に変更したり、さらにajaxとjavascriptまたはjqueryのDOM操作を利用すると、ページ遷移せずにページの一部のみを書き換えられるのでよりリッチなアプリケーションを手軽に設計できます。ページ遷移することのないサクサクとした操作感を得られるので、ユーザビリティの観点からも
                                        ajaxとDOM操作を基軸にアプリをデザインするのが良いと思います。</p>
                                      <p>HTMLを表示したあとにajaxによる非同期通信とDOM操作で部分的にページを書き換えるサンプルを示します。<br> さきほどの解説のようにFormからajaxでデータ送信ときのMethodをPOSTとしてhttp_request() イベント側で場合分けし易いようにしてあります。</p>
                                      <script src="https://gist.github.com/masterpoppy/f657e9618615a3796afca41013c7ab1e.js"></script>
                                      <p><a href="media-hud1/Animation-0.gif" target="_blank"><img class="alignnone wp-image-1095 size-large" src="media-hud1/Animation-0.gif" alt="animation-0" width="917" height="476"
                                            srcset="media-hud1/Animation-0.gif 1024w, media-hud1/Animation-0.gif 512w, media-hud1/Animation-0.gif 768w" sizes="(max-width: 917px) 100vw, 917px"></a></p>
                                      <p style="text-align: center;">実行結果 (クリックでおおきい画像を表示します)</p>
                                      <p>javascript内で完結してももちろん同じことが出来ますが、ここではデモンストレーションのためにあえてサーバーを通してデータ送受信する処理で作っています。<br> テキストボックスに入力した内容とクリックしたボタンのidををJSONにしてhttp-inサーバーに送信、responseもJSONとしました。 JSONで複雑なデータも一度に送受信できるので便利です。
                                        押したボタンのidでresponseするJSONの内容を振り分けています。 ここでは”text”は入力内容をそのまま使用、”style”は`赤で表示`を押した場合はCSSで”color”: “red”、`青で表示`を押した場合は”color”: “blue”を返すようにしました。</p>
                                      <p>ボタンを押したときにHUDからhttp-inに送信されるJSON (`赤で表示`を押した場合)</p>
                                      <script src="https://gist.github.com/masterpoppy/ee9f525124601575e90db8333c35a48f.js"></script>
                                      <p>処理が完了してhttp-inからHUDにresponseされるJSON (`赤で表示`を押した場合)</p>
                                      <script src="https://gist.github.com/masterpoppy/ba583ce2a0f4179eda1a3157219d69f1.js"></script>
                                      <p>js側に返ってきたjsonを元にDOM操作で部分書き換えしています。<br> LSLとajax通信するタイプのアプリは基本的にこの流れでの実装になるかと思います。</p>
                                      <p>ページを記述するためのhtmlやjavascriptは基本的に1つのstringにまとめる書き方とし、ページをデザインする段階では.htmlファイルとして別に作成しておいて、デザインが出来上がったらLSL側のstring HTML_BODYにコピー＆ペーストする手順が効率的かと思います。
                                        HTML部分だけを別ファイルで作ると、エディター内蔵のHTMLプレビューでレイアウトを確認したりブラウザの開発者ツールでデバッグできるのもいいところです。<br> ※ATOMやSublimetextのようにのlsl, html, javascriptなど複数の言語に対応した外部エディターでの開発を想定しています。</p>
                                      <p>phpのように複数のstringを文字列操作で結合・挿入などでページを生成する方法は処理が煩雑になり個人的にはあまりおすすめできません。 ただしはじめからLSLで動的にページ生成するという思想も考えられますので、そちらの手法は別のだれかに解説を委ねることにします。</p>
                                      <h2>LSL内にhtmlを記述するときのヒント</h2>
                                      <p>LSLのstring内にhtmlのコードを書いていて、私が気づいたノウハウを書いておきます。 ほかにもあればぜひ教えてください。</p>
                                      <ul>
                                        <li><strong>javascriptで扱う文字列データは””ではなく”で囲う。</strong><br> HTMLをstring変数のなかに書くことになるんで、文字列を””(ダブルクオート)で囲って記述すると.htmlのソースからlslのstringに貼り付けるときに、すべての”(ダブルクオート)にエスケープシーケンスをつけて\”に置き換える必要があります。
                                          この手間をなくすために、はじめから文字列を”(シングルクオート)で囲って記述するのがおすすめです。</li>
                                        <li><strong>インデントは全て詰める。</strong><br> string HTML_BODY内はHTMLのページをレンダリングするためには必要ないので全て詰めます。 上述のサンプルコード２では可読性を優先してインデントを残しましたが、アプリが複雑化するほどインデントが食う容量が64kbの壁を圧迫しますので、基本的にHTMLのコードをstringに貼り付けたときにすべて詰めてしまいましょう。
                                          さきほどのサンプルコード２の場合での例を示します。 可読性は損なわれますがHTMLのコードを確認するときは元の.htmlファイルをみるということで。</li>
                                      </ul>
                                      <script src="https://gist.github.com/masterpoppy/03fa6fd6800094cd5245850132c7ae58.js"></script>
                                      <ul>
                                        <li><strong>類似処理は極力ユーザ関数にまとめる</strong><br> 2回以上同じ処理を使う場合はユーザ関数にまとめて少しでも文字数を減らすようにコーディングします。 理由はおなじくLSLのメモリ節約のためです。</li>
                                      </ul>
                                      <ul>
                                        <li><strong>CSSによる複雑なUIデザインはではなく外部ファイルを使う</strong><br> ボタンのデザインを凝ったり複雑なUIを設計する場合は外部に.cssや.jsファイルをおいて読み込まるか、あるは公開cdnからフレームワークを読み込んで利用します。 同様にLSLのメモリ節約のためです。</li>
                                      </ul>
                                      <ul>
                                        <li><strong>HUDのアスペクト比は1:1, 1:2, 1:4, 2:1など1:2^nまたは2^n:1に限定される</strong><br>
                                          <a href="http://wiki.secondlife.com/wiki/LlSetLinkMedia#Caveats" target="_blank">http://wiki.secondlife.com/wiki/LlSetLinkMedia#Caveats</a> ※注意 日本語のページには書いていません<br>
                                          PRIM_MEDIA_WIDTH_PIXELS (メディアの横ピクセル数)とPRIM_MEDIA_HEIGHT_PIXELS(メディアの縦ピクセル数)に制限があって、1024×1024、1024×256、512×1024などに制限されるため、それに合わせてプリムのサイズのアスペクト比も1:1、4:1、1:2などに制限されます。解像度をここから外れた設定にすると周りに白い枠ができてしまいます。</li>
                                      </ul>
                                      <p>HTMLでのHUD開発 (勝手にMedia HUDと読んでいます) はHTML/CSS/javascript/jqueryさらにHTTP GET・POSTにはじまりajaxだとか色々とWeb技術について覚える事が多いですが、一度使い方がわかってしまえば圧倒的に効率的なHUDアプリ開発を進められます。 ぜひこの新しい開発方法を試してみてください。</p>
                                      <p>次回はajaxややフレームワークを応用したHUDアプリの作例を紹介していきます。</p>
                                      <p style="padding-left: 30px;">2日め: Media HUD…HTMLでHUDを開発する(2/3)<br>
                                        <a href=" https://masterpoppy2.github.io/archive/index2.html"></a></p>
                                      <div class="clear"></div>
                                    </div>
                                    <div class="tags"> &nbsp; </div>
                                  </div>
                                </div>
                                <div class="clear"></div>
                              </div>
                            </div>

                            <div id="pagination" class="copy fix">
                              <div class="copy-pad">
                                <div class="clear"></div>
                              </div>
                            </div>

                          </div>
                        </div>
                      </div>

                    </div>
                    <div class="clear"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="clear"></div>
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript" src="media-hud1/superfish.js"></script>
  <script type="text/javascript" src="media-hud1/jquery.bgiframe.min.js"></script>
  <script type="text/javascript" src="media-hud1/form.js"></script>
  <script type="text/javascript" src="media-hud1/shCore.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushAS3.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushBash.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushColdFusion.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushClojure.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushCpp.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushCSharp.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushCss.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushDelphi.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushDiff.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushErlang.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushFSharp.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushGroovy.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushJava.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushJavaFX.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushJScript.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushLatex.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushMatlabKey.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushObjC.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushPerl.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushPhp.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushPlain.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushPowerShell.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushPython.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushR.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushRuby.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushScala.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushSql.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushVb.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushXml.js"></script>
  <script type="text/javascript" src="media-hud1/shBrushLsl.js"></script>
  <script type="text/javascript">
    /*<![CDATA[*/
    (function() {
      var corecss = document.createElement('link');
      var themecss = document.createElement('link');
      var corecssurl = "https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
      if (corecss.setAttribute) {
        corecss.setAttribute("rel", "stylesheet");
        corecss.setAttribute("type", "text/css");
        corecss.setAttribute("href", corecssurl);
      } else {
        corecss.rel = "stylesheet";
        corecss.href = corecssurl;
      }
      document.getElementsByTagName("head")[0].insertBefore(corecss, document.getElementById("syntaxhighlighteranchor"));
      var themecssurl = "https://web.archive.org/web/20171014193028/http://masterpoppy.inspi.me/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
      if (themecss.setAttribute) {
        themecss.setAttribute("rel", "stylesheet");
        themecss.setAttribute("type", "text/css");
        themecss.setAttribute("href", themecssurl);
      } else {
        themecss.rel = "stylesheet";
        themecss.href = themecssurl;
      }
      document.getElementsByTagName("head")[0].insertBefore(themecss, document.getElementById("syntaxhighlighteranchor"));
    })();
    SyntaxHighlighter.config.strings.expandSource = 'ソースを表示';
    SyntaxHighlighter.config.strings.help = 'SyntaxHighlighterについて';
    SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
    SyntaxHighlighter.config.strings.noBrush = '指定のブラシが見つかりませんでした: ';
    SyntaxHighlighter.config.strings.brushNotHtmlScript = 'HTMLスクリプトのオプションのためにブラシが構成されませんでした: ';
    SyntaxHighlighter.defaults['pad-line-numbers'] = false;
    SyntaxHighlighter.all(); /*]]>*/
  </script>
  <script type="text/javascript" src="media-hud1/f4b8576cffaf1a3a35e845daf5984953-compressor-part.js"></script>
</body>

</html>
